[phases.setup]
nixPkgs = ["binutils", "gcc", "rust-bin.stable.latest.default"]

[phases.install]
cmds = ["cargo fetch"]

[phases.build]
env = { SQLX_OFFLINE = "true" }
cmds = [
    "mkdir -p bin",
    '''
    echo "Building package: $PACKAGE_NAME"
    cargo build --release -p $PACKAGE_NAME
    cp target/release/$PACKAGE_NAME bin/
    '''
]

SQLX_OFFLINE = "true"
RUST_LOG = "trace"
